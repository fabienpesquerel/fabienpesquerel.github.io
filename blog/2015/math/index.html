<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> a post with math | Fabien Pesquerel </title> <meta name="author" content="Fabien Pesquerel"> <meta name="description" content="an example of a blog post with some math"> <meta name="keywords" content="blog, pesquerel, fabien-pesquerel, machine-learning, reinforcement-learning, computer-vision, automated-translation, recommender-system, statistics, NLP"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fabienpesquerel.github.io/blog/2015/math/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Fabien</span> Pesquerel </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">a post with math</h1> <p class="post-meta"> Created in October 20, 2015 </p> <p class="post-tags"> <a href="/blog/2015"> <i class="fa-solid fa-calendar fa-sm"></i> 2015 </a>   ·   <a href="/blog/tag/formatting"> <i class="fa-solid fa-hashtag fa-sm"></i> formatting</a>   <a href="/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> math</a>   ·   <a href="/blog/category/sample-posts"> <i class="fa-solid fa-tag fa-sm"></i> sample-posts</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This theme supports rendering beautiful math in inline and display modes using <a href="https://www.mathjax.org/" rel="external nofollow noopener" target="_blank">MathJax 3</a> engine. You just need to surround your math expression with <code class="language-plaintext highlighter-rouge">$$</code>, like <code class="language-plaintext highlighter-rouge">$$ E = mc^2 $$</code>. If you leave it inside a paragraph, it will produce an inline expression, just like \(E = mc^2\).</p> <p>To use display mode, again surround your expression with <code class="language-plaintext highlighter-rouge">$$</code> and place it as a separate paragraph. Here is an example:</p> \[\sum_{k=1}^\infty |\langle x, e_k \rangle|^2 \leq \|x\|^2\] <p>You can also use <code class="language-plaintext highlighter-rouge">\begin{equation}...\end{equation}</code> instead of <code class="language-plaintext highlighter-rouge">$$</code> for display mode math. MathJax will automatically number equations:</p> <p>\begin{equation} \label{eq:cauchy-schwarz} \left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right) \end{equation}</p> <p>and by adding <code class="language-plaintext highlighter-rouge">\label{...}</code> inside the equation environment, we can now refer to the equation using <code class="language-plaintext highlighter-rouge">\eqref</code>.</p> <p>Note that MathJax 3 is <a href="https://docs.mathjax.org/en/latest/upgrading/whats-new-3.0.html" rel="external nofollow noopener" target="_blank">a major re-write of MathJax</a> that brought a significant improvement to the loading and rendering speed, which is now <a href="http://www.intmath.com/cg5/katex-mathjax-comparison.php" rel="external nofollow noopener" target="_blank">on par with KaTeX</a>.</p> <p>In the field of <strong>Machine Learning</strong>, the practitioner has to work (numerically) with random variables. It is therefore natural to wonder <em>how to sample from a random variable with a computer</em>.</p> <p>To put it in a nutshell: <strong>How to handle randomness with computers?</strong></p> <h2 id="-syllabus"> <i class="fas fa-route" style="font-size: 1.1em; background-color: transparent;"></i> Syllabus</h2> <p>This tutorial has three main parts.</p> <p><i class="fas fa-dice-one" style="font-size: 1.4em; background-color: transparent;"></i> <a href="#part1" style="font-size: 1.4em">Random Number Generation</a></p> <ul> <li> <strong>Handle randomness</strong> with a computer</li> <li> <strong>Understand reproducibility</strong> in numerical probability</li> <li>Implement your own random number generator. Simulate a lot of probability distributions!</li> </ul> <p><i class="fas fa-dice-two" style="font-size: 1.4em; background-color: transparent;"></i> <a href="#part2" style="font-size: 1.4em">Hands on Statistics</a></p> <ul> <li>Compute the <strong>expected value</strong> of a random variable</li> <li>Compute the <strong>standard deviation</strong> and <strong>quantiles</strong> of a random variable</li> <li>Visualize the <strong>weak</strong> and <strong>strong</strong> law of large numbers</li> </ul> <p><i class="fas fa-dice-three" style="font-size: 1.4em; background-color: transparent;"></i> <a href="#part3" style="font-size: 1.4em">Markov Reward Process</a></p> <ul> <li>Understand what a <strong>Markov Reward Process</strong> is</li> <li>Simulate <strong>Random Walk</strong> and <strong>Brownian Motion</strong> </li> <li>Compute the <strong>value function of a Markov Reward Process</strong> </li> </ul> <p>All code snippets can be <em>copied</em> using the <i class="fas fa-copy" style="font-size: 1.2em; background-color: transparent;"></i> button.</p> <hr> <p>The github repository is</p> <div class="repositories d-flex flex-column justify-content-between align-items-center"> <div class="repo p-2 text-center"> <a href="https://github.com/fabienpesquerel/ComputationalStatistics_Class" target="_blank" rel="noopener noreferrer"> <img class="repo-img-light w-100" alt="fabienpesquerel/ComputationalStatistics_Class" src="https://github-readme-stats.vercel.app/api/pin/?username=fabienpesquerel&amp;repo=ComputationalStatistics_Class&amp;theme=default&amp;show_owner=false"> <img class="repo-img-dark w-100" alt="fabienpesquerel/ComputationalStatistics_Class" src="https://github-readme-stats.vercel.app/api/pin/?username=fabienpesquerel&amp;repo=ComputationalStatistics_Class&amp;theme=dark&amp;show_owner=false"> </a> </div> </div> <p>Feel free to use it in order to raise an issue about this post or open the discussion about any related topic.</p> <hr> <p>We start by importing a few necessary libraries, modules and functions.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfinv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span></code></pre></figure> <h1 id="part-1---random-number-generation"><a id="part1">Part 1 - Random Number Generation</a></h1> <p>The main purpose of this part is to raise awareness of the importance of <strong>reproducibility</strong> as well as teach a <em>(random) bit</em> about algorithmic <strong>random number generation</strong>.</p> <p>Please ponder over the following question before delving into the practical: <em>How would you generate a random sequence of numbers?</em></p> <p>Can you even think of a high level definition of what it means for a sequence of numbers to be random or random enough?</p> <p>In machine learning, we deal with <strong>random numbers</strong> and we need an efficient way to generate random numbers according to some probability distribution. We say that we need a way to <strong>simulate</strong> the <strong>law of a random variable</strong>. On the other hand, there is a huge need for <strong>reproducibility</strong> of the experiments. Reproducibility is a major principle of the scientific method and machine learning (or statistical learning) is no exception. In algorithmic (apart from the very specific field of quantum computing) there is no reason we shouldn’t be able to <strong>reproduce exactly</strong> an experiment. Therefore, we want to generate random numbers as well as control how those numbers are generated so that we can <strong>reproduce computer experiments in pseudo-stochastic environment</strong>.</p> <p>At first glance, <em>reproducibility</em> and <em>randomness</em> may seem like opposite goals.</p> <p>An algorithm that generates random numbers is called a <strong>random number generator</strong> and the initial input to this algorithm that allows reproducibility is called the <strong>seed</strong>.</p> <h4 id="question-1">Question 1</h4> <p>Using <code class="language-plaintext highlighter-rouge">numpy</code>, generate two random numbers between 0 and 1 by calling the function <code class="language-plaintext highlighter-rouge">np.random.rand</code>. What is different compared to other function calls (<em>e.g.</em> <code class="language-plaintext highlighter-rouge">np.sqrt(2)</code>)?</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Don't know something? Ask questions on the github repo or read the doc!
</span><span class="err">?</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span></code></pre></figure> <h4 id="answer-1">Answer 1</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling np.random.rand(1) twice.</span><span class="se">\n\
</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Calling np.sqrt(2) twice.</span><span class="se">\n\
</span><span class="s">np.sqrt(2) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">np.sqrt(2) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calling np.random.rand(1) twice.
np.random.rand(1) = [0.49799233]
np.random.rand(1) = [0.75253602]

Calling np.sqrt(2) twice.
np.sqrt(2) = 1.4142135623730951
np.sqrt(2) = 1.4142135623730951
</code></pre></div></div> <p>What may be surprising (or not, if your are used to it) is that two calls of the same function lead to two different answers (seemingly with the same argument).</p> <p>At a high level, if we assume that the process that generates thr outputs of successive calls to <code class="language-plaintext highlighter-rouge">np.random.rand</code> is deterministic, then the so called <em>initial condition</em> should be enough to completly describe the generated sequence. If the process is <em>complex enough</em>, it may appear random while being completly determnistic and fully described by the generation process and initial condition.</p> <p>For random number generation, this initial condition is called the <strong>seed</strong>.</p> <h4 id="question-2">Question 2</h4> <p>The previous question enlightens the fact that there is a need to set the <strong>seed</strong> so that we can start over a <em>random experiment</em>. We could use <code class="language-plaintext highlighter-rouge">np.random.seed</code> to specify a <strong>global seed</strong> but this is <strong>not</strong> the recommended way.</p> <p><em>The preferred best practice for getting reproducible pseudorandom numbers is to instantiate a generator object with a seed and pass it around. The implicit global <code class="language-plaintext highlighter-rouge">RandomState</code> behind the <code class="language-plaintext highlighter-rouge">numpy.random.</code> convenience functions can cause problems, especially when threads or other forms of concurrency are involved. Global state is always problematic. We categorically recommend avoiding using the convenience functions when reproducibility is involved.</em> —Robert Kern, <a href="https://numpy.org/neps/nep-0019-rng-policy.html" target="_blank" rel="noopener noreferrer">NEP 19</a></p> <p>Use <code class="language-plaintext highlighter-rouge">np.random.default_rng</code> to instanciate a random number generator, generate some random numbers and prove yourself that you know how to start over the generation by generating the same (first) random numbers.</p> <h4 id="answer-2">Answer 2</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s">"ThisIsTheStartOfTheSchoolYear"</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">**</span><span class="mi">31</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling np.random.rand(1) twice.</span><span class="se">\n\
</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling rng.random(1) twice.</span><span class="se">\n\
</span><span class="s">rng.random(1) = </span><span class="si">{</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">rng.random(1) = </span><span class="si">{</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calling np.random.rand(1) twice.
np.random.rand(1) = [0.73463129]
np.random.rand(1) = [0.50966735]

Calling rng.random(1) twice.
rng.random(1) = [0.55043942]
rng.random(1) = [0.18440082]
</code></pre></div></div> <p>We start over by feeding the same seed to <code class="language-plaintext highlighter-rouge">np.random.default_rng</code>.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s">"ThisIsTheStartOfTheSchoolYear"</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">**</span><span class="mi">31</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling np.random.rand(1) twice.</span><span class="se">\n\
</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">np.random.rand(1) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling rng.random(1) twice.</span><span class="se">\n\
</span><span class="s">rng.random(1) = </span><span class="si">{</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">rng.random(1) = </span><span class="si">{</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calling np.random.rand(1) twice.
np.random.rand(1) = [0.86537091]
np.random.rand(1) = [0.96680284]

Calling rng.random(1) twice.
rng.random(1) = [0.55043942]
rng.random(1) = [0.18440082]
</code></pre></div></div> <h3 id="our-own-random-number-generator-in-01">Our own random number generator (in \(]0,1[\))</h3> <p>In the next question, you will implement a <strong>Linear Congruential random number generator</strong>. Such a <em>rng</em> (random number generator) works as follow. Given an initial integer \(x_0 \in (\underline{M}, \overline{M})\) and an integer function</p> <p>[f : x \in (\underline{M}, \overline{M}) \mapsto f(x) \in (\underline{M}, \overline{M}) ,]</p> <p>we generate a sequence of integers by repeatedly applying the function \(f\):</p> <p>[x_{n+1} = f(x_n) .]</p> <p>Given \(x_n \in \mathbb{N}\), we can map this integer to a rational \(u_n \in \mathbb{Q} \cap ]0,1[\) by computing</p> <p>[u_n = \frac{x_n - \underline{M}}{\overline{M}- \underline{M}} .]</p> <p>This procedure allows to generate a sequence \((u_n)_n\) of numbers in \(]0,1[\). If the function \(f\) is well chosen, then the sequence \((u_n)_n\) may <em>appear like</em> a sampling from a uniform distribution in \(]0,1[\) (this has a precise mathematical meaning in the field that study this topic).</p> <p>For mathematical reason, we avoid the value \(0\) and we therefore skip it in any algorithm that implements a <em>rng</em> in the aformentionned fashion. That is to say, if \(x_n = 0\) then set \(x_n\) to \(f(0)\). Therefore, \(f(0)\) should not be equal to \(0\).</p> <p><em>Remark</em>: skipping \(0\) may be a property of the <em>rng</em> or a property of the function that calls the <em>rng</em>. In the following, we make it a property of the <em>rng</em>.</p> <p>The <strong>Linear Congruential random number generator</strong> (LC-rng) is a function \(f\) of the form \(f(x) = mx + c \hspace{0.3cm} [q]\), that is to say,</p> <p>[x_{n+1} = m x_n + c \hspace{0.3cm} [q] .]</p> <h4 id="question-3">Question 3</h4> <p>Implement a <code class="language-plaintext highlighter-rouge">class</code>, <code class="language-plaintext highlighter-rouge">LC_RNG</code>, that takes a seed (\(x_0\)) as an input and is able to generate a random sequence of numbers in \(]0, 1[\) by calling a <code class="language-plaintext highlighter-rouge">random</code> method (it should mimick the behavior of numpy’s).</p> <p>Use the values \(m = 1103515245\), \(c = 12345\) and \(q = 2^{31}\).</p> <h4 id="answer-3">Answer 3</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">LC_RNG</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="n">seed</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="mi">1103515245</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">12345</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span>
    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Generator (LC_RNG customed)"</span>
    
    <span class="k">def</span> <span class="nf">generate_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span>
        
    <span class="k">def</span> <span class="nf">_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pseudo_random_int</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pseudo_random_int</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span>
    
    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbr_samples</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nbr_samples</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_samples</span><span class="p">):</span>
                <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_random</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">samples</span>
    
    <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pseudo_random_float</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">erfinv</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pseudo_random_float</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></code></pre></figure> <p>Remember the seed,</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s">"ThisIsTheStartOfTheSchoolYear"</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">**</span><span class="mi">31</span></code></pre></figure> <p>We test our random number generator,</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">custom_rng</span> <span class="o">=</span> <span class="n">LC_RNG</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling custom_rng.random(1) twice.</span><span class="se">\n\
</span><span class="s">custom_rng.random(1) = </span><span class="si">{</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">custom_rng.random(1) = </span><span class="si">{</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calling custom_rng.random(1) twice.
custom_rng.random(1) = [0.26866815984249115]
custom_rng.random(1) = [0.2322915312834084]
</code></pre></div></div> <p>Resetting the seed will restart the same generating process.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">custom_rng</span> <span class="o">=</span> <span class="n">LC_RNG</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calling custom_rng.random(1) twice.</span><span class="se">\n\
</span><span class="s">custom_rng.random(1) = </span><span class="si">{</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">custom_rng.random(1) = </span><span class="si">{</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calling custom_rng.random(1) twice.
custom_rng.random(1) = [0.26866815984249115]
custom_rng.random(1) = [0.2322915312834084]
</code></pre></div></div> <p>This kind of algorithm allows us to generate a random sequence of <code class="language-plaintext highlighter-rouge">float</code> in the bounded interval \(]0, 1[\) that is approximately uniformly distributed on this support. From now on, we shall assume in all simulations that the samples from <code class="language-plaintext highlighter-rouge">np.random.default_rng</code> are <em>independently and identically distributed</em> according to a uniform distribution in \(]0,1[\).</p> <h4 id="question-4">Question 4</h4> <p>What is the name of the generator that is used by the default call to <code class="language-plaintext highlighter-rouge">np.random.default_rng</code>?</p> <h4 id="answer-4">Answer 4</h4> <p>What kind of generator is used by default? We can find out by reading the doctstring <code class="language-plaintext highlighter-rouge">?np.random.default_rng</code> (or <code class="language-plaintext highlighter-rouge">help(np.random.default_rng)</code> ) or simply using <code class="language-plaintext highlighter-rouge">print</code> on the created object. As we can see, this is <a href="https://en.wikipedia.org/wiki/Permuted_congruential_generator" target="_blank" rel="noopener noreferrer">PCG64</a>.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="err">?</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">default_rng</span>
<span class="k">print</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Generator(PCG64)
</code></pre></div></div> <h4 id="question-5">Question 5</h4> <p>Using <code class="language-plaintext highlighter-rouge">np.random.default_rng</code>, generate a sequence of 10 000 samples in \(]0,1[\) and plot a histogram. Do the same with your custom rng, <code class="language-plaintext highlighter-rouge">LC_RNG</code>.</p> <h4 id="answer-5">Answer 5</h4> <p>To compute a histogram, one must <strong>arbitrarily</strong> partition the segment \(]0,1[\) into sub-interval whose union is the whole segement. In this case, partioning can be seen as a discretization of the probability density function (often abbreviated <a href="https://en.wikipedia.org/wiki/Probability_density_function" target="_blank" rel="noopener noreferrer">pdf</a>) with respect to the Lebesgue measure. In computer science, a sub-segment of this sub-division is called a <em>bin</em>.</p> <p>A histogram is computed by counting the number of samples belonging to each bin. Those counts can be scaled by a common factor afterward. If the scaling factor is such that the sum of the value associated to bins is equal to \(1\), we talk about <strong>normalization</strong>. In this case, the histogram can be seen as a probability density function with respect to a discrete measure. This last remark is a bit advanced and you can pursue your reading even without understanding it, as long as you have an intuition of what a histogram represent.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Density histogram of 10 000 samples generated by np.random.default_rng with the seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)],</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by np.random.default_rng with the seed 947507683 </div> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Density histogram of 10 000 samples generated by custom_rng with the seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">([</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)],</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by custom_rng with the seed 947507683 </div> <h2 id="generatingsimulating-a-random-variables">Generating/Simulating a random variables</h2> <p><strong>Theorem (Inverse Transform Sampling)</strong> Let $U$ be a uniform random variable on \(]0,1[\) and \(X\) a real random variable. Assume that the <a href="https://en.wikipedia.org/wiki/Cumulative_distribution_function" target="_blank" rel="noopener noreferrer">cumulative distribution function</a> \(F_X\) of \(X\), \(F_X (u) = \mathbb{P} (X \leq u)\), is continuous. Then the random variable \(Y\),</p> <p>[Y = F_X^{-1}(U)]</p> <p>has distribution \(F_X\). That is to say, \(X\) and \(Y\) have the same law <i class="fas fa-square"></i>.</p> <p>An algorithmic consequence of this theorem is that to generate (or simulate) <em>i.i.d.</em> samples having the law of a random variable \(X\), one can first use a generator of uniform samples in \(]0,1[\) and then use the inverse distribution function \(F_X^{-1}\) to compute <em>i.i.d.</em> samples from \(X\).</p> <p>Of course, such a method assumes that we have a way to compute (or estimate with good enough precision) \(F_X^{-1}\).</p> <p><strong>Algorithm for generating a sample from random variable X using \(F_X^{-1}\)</strong></p> <ul> <li> <code class="language-plaintext highlighter-rouge">Generate</code> <em>u</em> <code class="language-plaintext highlighter-rouge">uniformly at random on</code> \(]0,1[\)</li> <li> <code class="language-plaintext highlighter-rouge">Output</code> \(F_x^{-1}(u)\)</li> </ul> <p>The function \(F_X^{-1}\) of a unitary centered Normal distribution (<em>a.k.a.</em> Gaussian), \(X \sim \mathcal{N}(0,1)\), is implemented in the next cell.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Gaussian distribution
</span><span class="n">F_gaussian_inv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">u</span> <span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">erfinv</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">F_gaussian_inv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Invert distribution function of a unitary centered gaussian random variable"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-14 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_3-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_3-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_3-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer5_3.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Invert distribution function of a unitary centered gaussian random variable </div> <h4 id="question-6">Question 6</h4> <p>Using <code class="language-plaintext highlighter-rouge">np.random.default_rng</code>, generate a sequence of 10 000 samples according to a unitary centered gaussian distribution and plot a histogram. Modify the <code class="language-plaintext highlighter-rouge">LC_RNG</code> to do the same with your custom rng.</p> <h4 id="answer-6">Answer 6</h4> <h5 id="simulation-using-numpy-random-number-generator">Simulation using <code class="language-plaintext highlighter-rouge">numpy</code> random number generator</h5> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Density histogram of 10 000 samples generated by np.random.default_rng with the seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s"> (gaussian)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by np.random.default_rng with the seed 947507683 (gaussian) </div> <h5 id="simulation-using-custom-random-number-generator">Simulation using <code class="language-plaintext highlighter-rouge">custom</code> random number generator</h5> <p>We add the <code class="language-plaintext highlighter-rouge">_normal</code> and <code class="language-plaintext highlighter-rouge">normal</code> methods to our <code class="language-plaintext highlighter-rouge">LC_RNG</code> class.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">LC_RNG</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="n">seed</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="mi">1103515245</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">12345</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span>
    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Generator (LCG customed)"</span>
    
    <span class="k">def</span> <span class="nf">generate_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span>
        
    <span class="k">def</span> <span class="nf">_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pseudo_random_int</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pseudo_random_int</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span>
    
    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbr_samples</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nbr_samples</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_samples</span><span class="p">):</span>
                <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_random</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">samples</span>
    
    <span class="k">def</span> <span class="nf">_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pseudo_random_float</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">erfinv</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pseudo_random_float</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbr_samples</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nbr_samples</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_normal</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_samples</span><span class="p">):</span>
                <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_normal</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">samples</span>
    
<span class="n">custom_rng</span> <span class="o">=</span> <span class="n">LC_RNG</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Density histogram of 10 000 samples generated by custom_rng with the seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s"> (gaussian)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">custom_rng</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer6_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by custom_rng with the seed 947507683 (gaussian) </div> <p>Great! Everything is visually pleasing! It seems to work! Yeah sure, but…</p> <h4 id="question-7">Question 7</h4> <p>What could have gone wrong? Implement a <code class="language-plaintext highlighter-rouge">Dummy_LC_RNG</code> class with \(c=1\) and \(m=128\). Re-do the previous experiments and try changing <code class="language-plaintext highlighter-rouge">m</code> from <em>128</em> to <em>127</em> and see what happens.</p> <h4 id="answer-7">Answer 7</h4> <p>First with \(m = 128\).</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Dummy_LC_RNG</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="n">seed</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span>
    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Dummy Generator (LCG customed)"</span>
    
    <span class="k">def</span> <span class="nf">generate_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">ctr</span>
        
    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pseudo_random_int</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pseudo_random_int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">generate_int</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pseudo_random_int</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">max_int</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dummy_rng</span> <span class="o">=</span> <span class="n">Dummy_LC_RNG</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">([</span><span class="n">dummy_rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)],</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by dummy_rng with the seed 947507683 (gaussian) and m=128 </div> <p>Then with \(m = 127\).</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dummy_rng</span> <span class="o">=</span> <span class="n">Dummy_LC_RNG</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">([</span><span class="n">dummy_rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)],</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer7_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of 10 000 samples generated by dummy_rng with the seed 947507683 (gaussian) and m=127 </div> <p>As it can be seen, one must be careful when crafting a pseudo random number generator. Furthermore, one should also be careful that \(x_{n+1}\) and \(x_n\) are <em>as independent as possible</em>. Although this may seem counter-intuitive to do so with a completely deterministic procedure, there are ways to measure the statistical correlation of samples.</p> <p>An analogy is the one of <a href="https://chance.dartmouth.edu/teaching_aids/books_articles/Mann.pdf" target="_blank" rel="noopener noreferrer">shuffling a deck of cards</a>. While shuffling is a completely deterministic procedure we have a feeling that after shuffling, if done correctly, we get a random permutation of the cards that is roughly independent from the original permutation of the deck before shuffling.</p> <h1 id="part-2---hands-on-statistics"><a id="part2">Part 2 - Hands on Statistics</a></h1> <p>In this part, we show how to compute the <strong>expected value</strong> of a sequence of numbers, or of a random variable that we can simulate. In both cases, the practionaer has access to a stream of numbers generated by a possibly unknown and possibly random process.</p> <p>Expected value is a mathematical way of answering the question: What’s happening <strong>on average</strong>?</p> <p>For instance, what is</p> <ul> <li>the average temperature in your city</li> <li>the average temperature in your city during winter</li> <li>the average height of trees</li> <li>the average time in air when a human is jumping</li> <li>The average number brain consumption of \(O_2\) when answering a maths question</li> <li>…</li> </ul> <p>It is often a first step into the modelisation or despcription of a system, albeit a coarse description. Later in this tutorial, we will see how to compute the standard deviation, a measure of dispersion around the average value.</p> <p>Compared to the <strong>median</strong>, another mathematical notion of average, the <strong>expected value</strong> is easier to compute on a sequential fashion.</p> <p>There are two main ways to compute the <strong>mean</strong> of a sequence of numbers, an <strong>offline</strong> and an <strong>online</strong> way. Given a sequence \((x_i)_{i \in \{1, \cdots , n \}}\) of real numbers, we can compute the mean \(\bar x_n\) by first computing the sum of all the elements, \(\sum_i x_i\) and then dividing by the number of elements. This is the <strong>offline</strong> method. If we were given a new number \(x_{n+1}\) we would have to re-do all the additions and division. Mathematically, the formula is:</p> <p>[\bar x_n = \frac{1}{n} \sum_{i=1}^n x_i .]</p> <p>The <strong>online</strong> way computes a <em>sequence of means</em>, \((\bar x_k)_{k \in \{1, \cdots , n \} }\), where \(\bar x_k\) is the mean of the subsequence (or slice) \((x_i)_{i \in \{1, \cdots , k \}}\). The last element of the sequence of means is the mean of the original sequence. Mathematically, we initiate the sequence with \(\bar x_1 = x_1\) and the update rule is:</p> <p>[\bar x_{k+1} = \frac{1}{k+1}(k \bar x_k + x_{k+1}) .]</p> <p>The advantage of the online method is that we don’t need to store the sequence of all samples and that we can immediatly update the mean once given a new sample.</p> <h4 id="question-8">Question 8</h4> <p>Check that the online methods indeed is correct.</p> <h4 id="answer-8">Answer 8</h4> <p>A proof can by made by induction with initial condition \(\bar x_1 = x_1\) and following induction step</p> <p>[\begin{aligned} \bar x_{k+1} &amp; = \frac{1}{k+1}(k \bar x_k + x_{k+1}) <br> &amp;= \frac{1}{k+1}(k \frac{1}{k} \sum_{i=1}^k x_i + x_{k+1}) <br> &amp;= \frac{1}{k+1} \sum_{i=1}^{k+1} x_i \end{aligned}]</p> <h4 id="question-9">Question 9</h4> <p>Write as many functions as you can to compute the mean of a <code class="language-plaintext highlighter-rouge">python list</code> and check on a random sequence if they give the same result. What can you say?</p> <h4 id="answer-9">Answer 9</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">mean_1</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">agg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">agg</span> <span class="o">+=</span> <span class="n">elm</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">agg</span> <span class="o">/</span> <span class="n">i</span>

<span class="k">def</span> <span class="nf">mean_2</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">elm</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">mean_3</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">mean_4</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">mean_5</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">fsum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"mean_1(samples)  = </span><span class="si">{</span><span class="n">mean_1</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">mean_2(samples)  = </span><span class="si">{</span><span class="n">mean_2</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">mean_3(samples)  = </span><span class="si">{</span><span class="n">mean_3</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s"> (same result than np.mean)</span><span class="se">\n\
</span><span class="s">mean_4(samples)  = </span><span class="si">{</span><span class="n">mean_4</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">mean_5(samples)  = </span><span class="si">{</span><span class="n">mean_5</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">np.mean(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s"> (float64)</span><span class="se">\n\
</span><span class="s">np.mean(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'float32'</span><span class="p">)</span><span class="si">}</span><span class="s"> (float32)</span><span class="se">\n\
</span><span class="s">np.mean(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'float16'</span><span class="p">)</span><span class="si">}</span><span class="s">  (float16)</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mean_1(samples)  = 0.5103409440103216
mean_2(samples)  = 0.5103409440103205
mean_3(samples)  = 0.5103409440103216 (same result than np.mean)
mean_4(samples)  = 0.5103409440103216
mean_5(samples)  = 0.5103409440103216
np.mean(samples) = 0.5103409440103216 (float64)
np.mean(samples) = 0.5103409290313721 (float32)
np.mean(samples) = 0.51025390625  (float16)
</code></pre></div></div> <p>Depending on the implementation, and the arithmetic precision used, we get differents results. Those differences are mainly due to how arithmetic precision is handled and the order in which we perform the operation. Even if some operations are associative in a mathematical way (on the paper), those may not be in floating point arithmetic due to the very finite nature of numerical computation. In floating point arithmetic \((a + b) + c \neq a + (b + c)\), see <a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic#Accuracy_problems" target="_blank" rel="noopener noreferrer">accuracy problems</a>.</p> <p>Below, we emphasize this fact by testing different ways of summing elements of a list.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">sum_1</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">agg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">agg</span> <span class="o">+=</span> <span class="n">elm</span>
    <span class="k">return</span> <span class="n">agg</span>

<span class="k">def</span> <span class="nf">sum_3</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">sum_4</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">sum_5</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">fsum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"sum_1(samples)  = </span><span class="si">{</span><span class="n">sum_1</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">sum_3(samples)  = </span><span class="si">{</span><span class="n">sum_3</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s"> (same result than np.mean)</span><span class="se">\n\
</span><span class="s">sum_4(samples)  = </span><span class="si">{</span><span class="n">sum_4</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">sum_5(samples)  = </span><span class="si">{</span><span class="n">sum_5</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="se">\n\
</span><span class="s">np.sum(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s"> (float64)</span><span class="se">\n\
</span><span class="s">np.sum(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'float32'</span><span class="p">)</span><span class="si">}</span><span class="s"> (float32)</span><span class="se">\n\
</span><span class="s">np.sum(samples) = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'float16'</span><span class="p">)</span><span class="si">}</span><span class="s">  (float16)</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sum_1(samples)  = 510.34094401032155
sum_3(samples)  = 510.34094401032155 (same result than np.mean)
sum_4(samples)  = 510.34094401032155
sum_5(samples)  = 510.3409440103216
np.sum(samples) = 510.34094401032155 (float64)
np.sum(samples) = 510.3409423828125 (float32)
np.sum(samples) = 510.25  (float16)
</code></pre></div></div> <h4 id="question-10">Question 10</h4> <p>Let \((X_i)_{i \in \{1, \cdots , n\}}\) be \(n\) <em>i.i.d.</em> random variables such that \(X_i \sim X\) with \(\mathbb{E}(X) = \mu\).</p> <p>The <strong>Law of large numbers</strong> states that the empirical mean of those \(n\) <em>i.i.d.</em> random variables,</p> <p>[\frac{X_1 + X_2 + \cdots + X_{n-1} + X_n}{n} ,]</p> <p>converges (in some sense) to \(\mu\) as \(n\) tends to infinity.</p> <p>Write an experiment that collects 10 000 samples from a unitary centered gaussian distribution, and computes the sequence of updated means. Plot the histogram of samples (as above) and the function \(k \mapsto \bar x_k\).</p> <h4 id="answer-10">Answer 10</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">experiment</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbr_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">nbr_samples</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">nbr_samples</span> <span class="o">=</span> <span class="n">nbr_samples</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span>
        
        <span class="c1"># We store information, only for the plots
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span> <span class="nf">update_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elm</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">nbr_samples</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">mean</span> <span class="o">+</span> <span class="n">elm</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">nbr_samples</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">nbr_samples</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># Storage for the plots
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">means</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mean</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">elm</span><span class="p">)</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">xp</span> <span class="o">=</span> <span class="n">experiment</span><span class="p">()</span>

<span class="n">nbr_experiments</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_experiments</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="n">xp</span><span class="p">.</span><span class="n">update_mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Samples repartition"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">xp</span><span class="p">.</span><span class="n">samples</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean estimation as a function of the number of samples"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">.</span><span class="n">means</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Samples repartition </div> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer10_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean estimation as a function of the number of samples </div> <p>It is quite interesting to see this random nature of the expected value, yet to know that in the long run, it will be close to the true average. In the next question, this random behavior is highlighted by plotting several trajectories. At the same time, the convergence of those plot to the same value emphasizes some regularity in this random behavior. Some of this regularity is clarified by the central limit theorem.</p> <h4 id="question-11">Question 11</h4> <p>Repeat 10 times the experiments of the previous question and plot the 10 trajectories \(k \mapsto \bar x_k\). Add the curves \(k \mapsto \pm \frac{1}{\sqrt{k}}\) to your plot. Comment if you remember the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem" target="_blank" rel="noopener noreferrer">central limit theorem</a>, otherwise, come back with the next question in hindsight.</p> <h4 id="answer-11">Answer 11</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">nbr_experiments</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">nbr_samples</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean estimation as a function of the number of samples"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_experiments</span><span class="p">):</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">experiment</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_samples</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="n">xp</span><span class="p">.</span><span class="n">update_mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">.</span><span class="n">means</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">501</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">501</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean estimation as a function of the number of samples </div> <p>By plotting more trajectories and removing the first initials time steps, one can better visualize the asymptotic results stated by the central limit theorem: the density of curves at the end point might look like a gaussian random variable.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">nbr_experiments</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">nbr_samples</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span><span class="mi">40</span><span class="p">)])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean estimation as a function of the number of samples"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_experiments</span><span class="p">):</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">experiment</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_samples</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="n">xp</span><span class="p">.</span><span class="n">update_mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">)],</span> <span class="n">xp</span><span class="p">.</span><span class="n">means</span><span class="p">[</span><span class="mi">20</span><span class="p">:])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">501</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">)],[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">501</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer11_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean estimation as a function of the number of samples </div> <h4 id="question-12">Question 12</h4> <p>Let \((X_i)_{i \in \{1, \cdots , n\}}\) be \(n\) <em>i.i.d.</em> random variables such that \(X_i \sim X\) with \(\mathbb{E}(X) = \mu\) and \(\mathbb{V}(X) = \sigma^2\). The <strong>Central Limit Theorem</strong> states that the empirical mean of those \(n\) <em>i.i.d.</em> random variables,</p> <p>[\frac{X_1 + X_2 + \cdots + X_{n-1} + X_n}{n} ,]</p> <p>has the law of a Gaussian random variable, \(\mathcal{N} (\mu, \frac{\sigma}{\sqrt{n}})\) in the limit of large \(n\).</p> <p>Let \(X\) be a random variable having the uniform law on \(]0,1[\). Craft an experiment to visualize the central limit theorem when samples are drawn from \(X\).</p> <h4 id="answer-12">Answer 12</h4> <p>We sample 300 000 lists of 1000 samples generated according to a uniform law in \(]0,1[\). For each list, we compute the mean and create a list of the 300 000 means. Then we plot a histogram of this list. If 1000 is large enough for the central limit theorem to roughly apply, then the histogram of the list of means resemble the one of a gaussian distribution with mean \(\mu = 0\) and standard deviation \(\sigma = 1/\sqrt{1000} \simeq 0.03\).</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">nbr_list</span> <span class="o">=</span> <span class="mi">300000</span>
<span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbr_list</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">means</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_1</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Means repartition"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer12_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer12_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer12_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer12_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Means repartition </div> <h2 id="standard-deviation-and-quantiles">Standard deviation and Quantiles</h2> <p>Given a list of samples drawn from a random variable \(X\), what relevant quantities could be computed? In the previous subsection, we emphasize the <strong>empirical mean</strong> and illustrate how it is related to the <strong>true mean</strong> \(\mathbb{E}(X)\). Given the empirical mean, it is natural to measure the spread of the samples around that value. In other words, we want to compute an empirical version of the <strong>standard deviation</strong>.</p> <p>There are two main ways of computing the empirical standard deviation. One that is called the <strong>uncorrected standard deviation</strong>,</p> <p>[\hat \sigma_u = \sqrt{\frac{1}{n} \sum_{i=1}^n (x_i - \hat \mu)^2}]</p> <p>and the other that is called the <strong>corrected standard deviation</strong></p> <p>[\hat \sigma_c = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (x_i - \hat \mu)^2}]</p> <p><em>Remark</em>: <code class="language-plaintext highlighter-rouge">np.std</code> computes the uncorrected standard deviation.</p> <p>Intuitively, it corresponds to two viewpoints on how to handle small sample size. When \(n=1\), \(\hat \sigma_u = 0\) while \(\hat \sigma_c = \frac{0}{0}\) <em>i.e.</em>, is not defined. Indeed, when \(n=1\), one could think one of the two things</p> <ul> <li>The empirical standard deviation is 0 since there is no deviation in the dataset</li> <li>The empirical standard deviation is undefined since there is no way to empirically compute a deviation in the dataset</li> </ul> <p>On the other hand, \(\hat \sigma_u \rightarrow \sigma\), and \(\hat \sigma_u \rightarrow \sigma\), meaning that both estimators have the same asymptotic behaviors (large sample size). In particular,</p> <p>[\frac{\hat \sigma_c}{\hat \sigma_u} =\sqrt{\frac{n}{n-1}} \rightarrow 1]</p> <p>Mathematically, \(\hat \sigma_u\) is a biased estimator (\(\mathbb{E}(\hat \sigma_u) \neq \sigma\)) and \(\hat \sigma_c\) is an unbiased estimator (\(\mathbb{E}(\hat \sigma_c) = \sigma\)). Bias is not necessarily a problem because a small bias can sometimes be traded against a reduction in the variance of the estimator (as it is the case here).</p> <h4 id="question-13">Question 13</h4> <p>Implement functions computing the two empirical standard deviation. Check that both numerically converges to \(\sigma\) as the number of samples increases.</p> <h4 id="answer-13">Answer 13</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">samples</span> <span class="o">=</span> <span class="n">custom_rng</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">500000</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">standard_deviation_uncorrected</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mean_1</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">samples</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">standard_deviation_corrected</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"The length of the samples array should be strictly larger than 1"</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mean_1</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">samples</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">standard_deviation_uncorrected</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">standard_deviation_corrected</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.0006729694819605
1.000673970156431
</code></pre></div></div> <p>Another natural way to compute the spread of a list of samples is <em>via</em> a function. This function associates a number \(F(x)\) to each interval \([\mu - x, \mu + x]\) with \(x&gt;0\); \(F(x)\) is the fraction of samples that lies within it. In particular, it is interesting to know the fraction of samples lying in \([\mu - \sigma, \mu + \sigma]\).</p> <p>For the readers aware of the notion, this is highly related to the concept of <strong>cumulative distribution function</strong>.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Density histogram of samples generated according a Gaussian distribution"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">standard_deviation_corrected</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mean_1</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.007</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">"full"</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">"black"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="s">"$\mu\pm\sigma$"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.007</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">"full"</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">"red"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="s">"$\mu\pm2\sigma$"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.007</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">"full"</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s">"pink"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">"pink"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="s">"$\mu\pm3\sigma$"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"pink"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer13_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer13_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer13_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer13_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Density histogram of samples generated according a Gaussian distribution </div> <h4 id="question-14">Question 14</h4> <p>What percentage of samples fall in the interval \([\mu - \sigma, \mu+\sigma]\)? and \([\hat\mu - \hat\sigma, \hat\mu+\hat\sigma]\)? Check the <a href="https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule" target="_blank" rel="noopener noreferrer">68-95–99.7 rule</a>.</p> <h4 id="answer-14">Answer 14</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sample</span> <span class="o">&gt;=</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">sigma</span> <span class="ow">and</span> <span class="n">sample</span> <span class="o">&lt;=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">:</span>
            <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ctr</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">percent</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">percent</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">percent</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span></code></pre></figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>68.22240000000001
95.41460000000001
99.72800000000001
</code></pre></div></div> <h4 id="question-15">Question 15</h4> <p>Implement a function that computes the \(\alpha\) quantile of a list of samples, that is to say, an empirical value \(\hat x_\alpha\) that corresponds to the true value \(x_\alpha\), defined as</p> <table> <tbody> <tr> <td>[x_\alpha = \sup_x { x :</td> <td>: \mathbb{P}(X \leq x) \leq \alpha } .]</td> </tr> </tbody> </table> <p>Using this function, how can you compute the <strong>median</strong>? How is the <a href="https://en.wikipedia.org/wiki/Median" target="_blank" rel="noopener noreferrer">median</a> different from the <a href="https://en.wikipedia.org/wiki/Arithmetic_mean" target="_blank" rel="noopener noreferrer">mean</a>?</p> <h4 id="answer-15">Answer 15</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">sorted_samples</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">samples</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></code></pre></figure> <p>To compute the empirical median, one can use the <code class="language-plaintext highlighter-rouge">quantile</code> function to compute \(\hat x_{1/2}\).</p> <h1 id="part-3---markov-reward-process"><a id="part3">Part 3 - Markov Reward Process</a></h1> <p>In the following, we consider sequences of random variables that are not necessarily <em>i.i.d.</em> That is, we will introduce a <em>dependency model</em> in the sequence of random variables. In the <em>i.i.d.</em> case, the index \(n \in \mathbb{N}\) of an element \(X_n\) of the sequence of random variables is somewhat arbitrary. It is mainly a way of pointing to an object in a collection. In the following, we introduce a type of dependency that is called <em>Markovian</em> and makes use of the <em>order</em> \(\leq\) of the natural number \(\mathbb{N}\). The element of the sequence are seen as if they were generated <em>in order</em> and the index <em>n</em> is often thought of as <em>time</em>. However, keep in mind that the Markov property can be extended beyond sequences indexed by natural number or ordered set. For instance, Markov random field are indexed by elements of topological space and neighborhoods give a dependency relation between the elements of the collection.</p> <p>Back to where we were, we want to study sequences represented as</p> <p>[X_0 \rightarrow X_1 \rightarrow X_2 \rightarrow \cdots \rightarrow X_n .]</p> <p>In the following, we shall assume that the generative process is Markovian, <em>i.e.</em>, the future is independent from the past given the present. The sequence may therefore be represented as</p> <table> <tbody> <tr> <td>[X_0 \overset{p(X_1</td> <td>X_0)}{\longrightarrow} X_1 \overset{p(X_2</td> <td>X_1)}{\longrightarrow} X_2 \overset{p(X_3</td> <td>X_2)}{\longrightarrow} \cdots \overset{p(X_n</td> <td>X_{n-1})}{\longrightarrow} X_n ,]</td> </tr> </tbody> </table> <p>where \(p\) is called the <strong>probability transition function</strong>. In the following, this function is independent of \(n\) (time homogeneity property). Therefore, the model may be represented more concisely:</p> <table> <tbody> <tr> <td>[X_{k-1} \overset{p(X_k</td> <td>X_{k-1})}{\longrightarrow} X_k ,]</td> </tr> </tbody> </table> <p>together with an initial distribution of \(X_0\).</p> <h4 id="question-16">Question 16</h4> <p>Consider the Markov chain</p> <table> <tbody> <tr> <td>[X_0 \overset{p(X_1</td> <td>X_0)}{\longrightarrow} X_1 \overset{p(X_2</td> <td>X_1)}{\longrightarrow} X_2 \overset{p(X_3</td> <td>X_2)}{\longrightarrow} \cdots \overset{p(X_n</td> <td>X_{n-1})}{\longrightarrow} X_n]</td> </tr> </tbody> </table> <p>where \(X_0 = 0\) and</p> <p>[\left{ \begin{array}{lcr} p (X_k = X_{k-1} + 1 | X_{k-1 }) &amp; = &amp; 0.5 <br> p (X_k = X_{k-1} - 1 | X_{k-1 }) &amp; = &amp; 0.5 <br> \end{array} \right.]</p> <p>Write a fonction that generate a sequence of \(n\) samples according to this process. Plot such a trajectory. Zoom-in. What can you say?</p> <h4 id="answer-16">Answer 16</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">random_walk</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">H</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">rw</span> <span class="o">=</span> <span class="n">random_walk</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"1D random walk"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rw</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 1D random walk </div> <p>An educated eye may see some auto-similarity pattern in the generated curve. That is to say, a similar pattern (made of up-and-down sharp wave) seems to be spotten at diffent scales. To investigate this property, we “zoom-in” by plotting only the curve between the times steps 4000 and 6000 instead of the whole 10 000 time steps represented above.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"1D random walk - zooming in"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">6000</span><span class="p">),</span><span class="n">rw</span><span class="p">[</span><span class="mi">4000</span><span class="p">:</span><span class="mi">6000</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 1D random walk - zooming in </div> <p>One can see that zooming-in does not really change the type of curve that we had at a larger scale. It is only when we zoom-in even further that we can start to see the characteristic length of 1 introduced by our generating method, \(X_{n+1} = X_n \pm 1\). Below, we zoom-in on 500 time steps only. Of course, another characteristic length is playing a role here, which is also equal to 1 and corresponds to the distance between two consecutive time steps.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"1D random walk - zooming in"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">4500</span><span class="p">),</span><span class="n">rw</span><span class="p">[</span><span class="mi">4000</span><span class="p">:</span><span class="mi">4500</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_3-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_3-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_3-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer16_3.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 1D random walk - zooming in (more) </div> <h3 id="discretized-brownian-motion">Discretized Brownian motion</h3> <h4 id="question-17">Question 17</h4> <p>Answer the same question than the previous one but with a process such that \(X_{n+1} \mid X_n \sim \mathcal{N}(X_n, \epsilon)\). That is to say,</p> <p>[X_{n+1} = X_n + G_n^{\epsilon}]</p> <p>where \((G_n^{\epsilon})_{n\in\mathbb{N}}\) is a sequence of <em>i.i.d.</em> gaussian random variable with the law \(\mathcal{N}(0,\epsilon)\).</p> <h4 id="answer-17">Answer 17</h4> <p>Intuitively, we should obtain a “similar” type of curve with a characteristic length of \(\epsilon\). However, because this process can take its values in \(\mathbb{R}\) rather than \(\mathbb{N}\) only, the characteristic time discretization will play a more important role in the viualizations of the plots.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">brownian_motion</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="n">values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">H</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">brownian_motion</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"1D Brownian motion"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 1D Brownian motion </div> <p>Indeed, we see the same auto-similar pattern and can try to zoom-in to better visualize this pattern.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"1D random walk - zooming in"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">6000</span><span class="p">),</span><span class="n">bm</span><span class="p">[</span><span class="mi">4000</span><span class="p">:</span><span class="mi">6000</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer17_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 1D random walk - zooming in </div> <h4 id="question-18">Question 18</h4> <p>Write a function that computes and plots a discretized Brownian motion in 2D.</p> <h4 id="answer-18">Answer 18</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">brownian_motion2d</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span>
        <span class="n">X</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">H</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">brownian_motion2d</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"2D Brownian motion"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"x"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"y"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 2D Brownian motion </div> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"2D Brownian motion - zooming in"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"x"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"y"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">5000</span><span class="p">:</span><span class="mi">7000</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">5000</span><span class="p">:</span><span class="mi">7000</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 2D Brownian motion - zooming in </div> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"2D Brownian motion - several trajectories"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"x"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"y"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">brownian_motion2d</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_3-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_3-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_3-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_3.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> 2D Brownian motion - several trajectories </div> <h2 id="random-walk-on-a-graph">Random walk on a graph</h2> <p>In the following, we will consider random walks on a graph where the set of vertices \(V\) is finite as well as the set of edges \(E\). At each vertex \(v \in V\) is attached a probability distribution \(p_v\) on the space of vertices such that \(p_v (n)\) is probability of going from vertex \(v\) to vertex \(n\). In the Markov reward process litterature, a vertex is often called a <strong>state</strong>.</p> <p>The specificity of Markov reward process is that a reward \(r\) function assign a number to each transition (or step). Formally, at each state \(v \in V\), \(r_v\) is a function that assign a reward \(r_v(n)\) to each transition from state \(v\) to state \(n\).</p> <p>To create a random walk on a graph, one first create a graph with weighted edges. Using those weight, we create a transition distribution at each vertex. Using the following code as a starting point, this is the topic of the next question.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="n">nx</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="n">Graph</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">gnp_random_graph</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">nx</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Graph</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s">'green'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_4-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_4-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_4-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer18_4.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Random directed graph </div> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Graph</span><span class="p">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">w</span><span class="p">[</span><span class="s">'weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">w</span><span class="p">[</span><span class="s">'reward'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span></code></pre></figure> <h4 id="question-19">Question 19</h4> <p>Given a labeled directed graph \(G = (V, E, w, r, v_0)\) where \(V\) is the set of vertices, \(E\) the set of edges, \(w: E \rightarrow ]0,1[\) and \(r: E \rightarrow \mathbb{R}\) and \(v_0 \in V\) we can compute a Markovian random walk on the vertices of \(G\) by considering that</p> <table> <tbody> <tr> <td>[p (v_i</td> <td>v_{i-1}) = \frac{w(v_{i-1}, v_i)}{\sum_v w(v_{i-1}, v)} .]</td> </tr> </tbody> </table> <p>The specificity of this random walk is that at each transition \(v_{i-1} \rightarrow v_i\), we collect a reward \(r(v_{i-1}, v_i)\).</p> <p>Write a function that generates a random walk along a graph, collects the history of vertices (<em>i.e.</em> samples) and collects the history of rewards. Plot the updated mean reward (it should be around 2, but why?).</p> <h4 id="answer-19">Answer 19</h4> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">random_walk_graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">starting_node</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">starting_node</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
        <span class="n">adj_data</span> <span class="o">=</span> <span class="n">G</span><span class="p">.</span><span class="n">adj</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">adj_data</span><span class="p">:</span>
            <span class="n">neighbors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">weights</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_data</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s">'weight'</span><span class="p">])</span>
        <span class="n">w</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">proba</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">/</span><span class="n">w</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
        <span class="n">next_node</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">proba</span><span class="p">)</span>
        <span class="n">nodes</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_node</span><span class="p">)</span>
        <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_data</span><span class="p">[</span><span class="n">next_node</span><span class="p">][</span><span class="s">'reward'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">samples</span></code></pre></figure> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">nodes</span><span class="p">,</span> <span class="n">rewards</span> <span class="o">=</span> <span class="n">random_walk_graph</span><span class="p">(</span><span class="n">Graph</span><span class="p">)</span>
<span class="n">mean_reward</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean cumulative reward gathered along random walk on a graph"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_reward</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_1-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_1-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_1-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_1.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean cumulative reward gathered along random walk on a graph </div> <p>Because all edges have an associated reward that is initially generated according to a gaussian distribution with mean 2, we expected the mean cumulative reward collected to be around this value. Of course, previous sections highlighted how the random nature of sampling can generate dispersion around the mean.</p> <h4 id="doing-more-experiments">Doing more experiments.</h4> <p>Below, we generate 10 graphs and for each one, compute the mean cumulative reward curve. We see that those curves all seem to converge and that those limit are gathered around 2 as we should expect.</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean cumulative reward gathered along random walk on a graph"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Graph</span><span class="p">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">w</span><span class="p">[</span><span class="s">'weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">w</span><span class="p">[</span><span class="s">'reward'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">nodes</span><span class="p">,</span> <span class="n">rewards</span> <span class="o">=</span> <span class="n">random_walk_graph</span><span class="p">(</span><span class="n">Graph</span><span class="p">)</span>
    <span class="n">mean_reward</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_reward</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_2-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_2-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_2-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_2.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean cumulative reward gathered along random walk on a graph </div> <p>To wrap it up, we generate gain 10 random graphs and for each one, compute the mean cumulative reward curve. We see that those curves all seem to converge and that those limit are gathered around 5 as we should expect. Why?</p> <div class="code-header"> <button class="copy-code-button fas fa-copy" aria-label="Copy code to clipboard"></button> </div> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Mean cumulative reward gathered along random walk on a graph"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"time steps"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Graph</span><span class="p">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">w</span><span class="p">[</span><span class="s">'weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">w</span><span class="p">[</span><span class="s">'reward'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">normal</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">rng</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">nodes</span><span class="p">,</span> <span class="n">rewards</span> <span class="o">=</span> <span class="n">random_walk_graph</span><span class="p">(</span><span class="n">Graph</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">mean_reward</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_reward</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_3-480.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_3-800.webp"></source>&lt;/source&gt; <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_3-1400.webp"></source>&lt;/source&gt; <img src="/assets/img/posts/2022-10-16-random-number-generation-101/rng_post_answer19_3.png" class="img-fluid rounded z-depth-1" style="background-color:white" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Mean cumulative reward gathered along random walk on a graph </div> <p><i class="fas fa-door-open" style="font-size: 1.5em; background-color: transparent;"></i> Experiment and play with those models! If you have any remarks or questions, feel free to reach me, my door is always open!</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Fabien Pesquerel. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-repositories",title:"repositories",description:"Edit the `_data/repositories.yml` and change the `github_users` and `github_repos` lists to include your own GitHub profile and repositories.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"To download my resume, please click on the pdf icon.",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-teaching",title:"teaching",description:"Materials for courses.",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"post-a-post-with-tabs",title:"a post with tabs",description:"this is what included tabs in a post could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/tabs/"}},{id:"post-a-post-with-typograms",title:"a post with typograms",description:"this is what included typograms code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/typograms/"}},{id:"post-a-post-that-can-be-cited",title:"a post that can be cited",description:"this is what a post that can be cited looks like",section:"Posts",handler:()=>{window.location.href="/blog/2024/post-citation/"}},{id:"post-a-post-with-pseudo-code",title:"a post with pseudo code",description:"this is what included pseudo code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/pseudocode/"}},{id:"post-a-post-with-code-diff",title:"a post with code diff",description:"this is how you can display code diffs",section:"Posts",handler:()=>{window.location.href="/blog/2024/code-diff/"}},{id:"post-a-post-with-advanced-image-components",title:"a post with advanced image components",description:"this is what advanced image components could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/advanced-images/"}},{id:"post-a-post-with-vega-lite",title:"a post with vega lite",description:"this is what included vega lite code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/vega-lite/"}},{id:"post-a-post-with-geojson",title:"a post with geojson",description:"this is what included geojson code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/geojson-map/"}},{id:"post-a-post-with-echarts",title:"a post with echarts",description:"this is what included echarts code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/echarts/"}},{id:"post-a-post-with-chart-js",title:"a post with chart.js",description:"this is what included chart.js code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2024/chartjs/"}},{id:"post-a-post-with-tikzjax",title:"a post with TikZJax",description:"this is what included TikZ code could look like",section:"Posts",handler:()=>{window.location.href="/blog/2023/tikzjax/"}},{id:"post-a-post-with-bibliography",title:"a post with bibliography",description:"an example of a blog post with bibliography",section:"Posts",handler:()=>{window.location.href="/blog/2023/post-bibliography/"}},{id:"post-a-post-with-jupyter-notebook",title:"a post with jupyter notebook",description:"an example of a blog post with jupyter notebook",section:"Posts",handler:()=>{window.location.href="/blog/2023/jupyter-notebook/"}},{id:"post-a-post-with-custom-blockquotes",title:"a post with custom blockquotes",description:"an example of a blog post with custom blockquotes",section:"Posts",handler:()=>{window.location.href="/blog/2023/custom-blockquotes/"}},{id:"post-a-post-with-table-of-contents-on-a-sidebar",title:"a post with table of contents on a sidebar",description:"an example of a blog post with table of contents on a sidebar",section:"Posts",handler:()=>{window.location.href="/blog/2023/sidebar-table-of-contents/"}},{id:"post-a-post-with-audios",title:"a post with audios",description:"this is what included audios could look like",section:"Posts",handler:()=>{window.location.href="/blog/2023/audios/"}},{id:"post-a-post-with-videos",title:"a post with videos",description:"this is what included videos could look like",section:"Posts",handler:()=>{window.location.href="/blog/2023/videos/"}},{id:"post-displaying-beautiful-tables-with-bootstrap-tables",title:"displaying beautiful tables with Bootstrap Tables",description:"an example of how to use Bootstrap Tables",section:"Posts",handler:()=>{window.location.href="/blog/2023/tables/"}},{id:"post-a-post-with-table-of-contents",title:"a post with table of contents",description:"an example of a blog post with table of contents",section:"Posts",handler:()=>{window.location.href="/blog/2023/table-of-contents/"}},{id:"post-a-post-with-giscus-comments",title:"a post with giscus comments",description:"an example of a blog post with giscus comments",section:"Posts",handler:()=>{window.location.href="/blog/2022/giscus-comments/"}},{id:"post-a-post-with-redirect",title:"a post with redirect",description:"you can also redirect to assets like pdf",section:"Posts",handler:()=>{window.location.href="/assets/pdf/example_pdf.pdf"}},{id:"post-a-post-with-diagrams",title:"a post with diagrams",description:"an example of a blog post with diagrams",section:"Posts",handler:()=>{window.location.href="/blog/2021/diagrams/"}},{id:"post-a-distill-style-blog-post",title:"a distill-style blog post",description:"an example of a distill-style blog post and main elements",section:"Posts",handler:()=>{window.location.href="/blog/2021/distill/"}},{id:"post-a-post-with-twitter",title:"a post with twitter",description:"an example of a blog post with twitter",section:"Posts",handler:()=>{window.location.href="/blog/2020/twitter/"}},{id:"post-a-post-with-disqus-comments",title:"a post with disqus comments",description:"an example of a blog post with disqus comments",section:"Posts",handler:()=>{window.location.href="/blog/2015/disqus-comments/"}},{id:"post-a-post-with-math",title:"a post with math",description:"an example of a blog post with some math",section:"Posts",handler:()=>{window.location.href="/blog/2015/math/"}},{id:"post-a-post-with-code",title:"a post with code",description:"an example of a blog post with some code",section:"Posts",handler:()=>{window.location.href="/blog/2015/code/"}},{id:"post-a-post-with-images",title:"a post with images",description:"this is what included images could look like",section:"Posts",handler:()=>{window.location.href="/blog/2015/images/"}},{id:"post-a-post-with-formatting-and-links",title:"a post with formatting and links",description:"march & april, looking forward to summer",section:"Posts",handler:()=>{window.location.href="/blog/2015/formatting-and-links/"}},{id:"news-it-is-christmas-christmas-tree-and-i-recently-sucessfully-defended-my-phd-mortar-board-read-the-manuscript-book-here",title:'It is Christmas <img class="emoji" title=":christmas_tree:" alt=":christmas_tree:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f384.png" height="20" width="20"> and I recently sucessfully defended my PhD <img class="emoji" title=":mortar_board:" alt=":mortar_board:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f393.png" height="20" width="20"> !...',description:"",section:"News"},{id:"news-office-i-am-starting-a-postdoc-in-the-pirat-team-at-inria-centralesupelec-rennes",title:'<img class="emoji" title=":office:" alt=":office:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e2.png" height="20" width="20"> I am starting a postdoc in the PIRAT team at INRIA, CentraleSupelec...',description:"",section:"News"},{id:"news-japan-i-am-starting-to-learn-japanese-hope-to-progress-steadily-and-quickly-izakaya-lantern",title:'<img class="emoji" title=":japan:" alt=":japan:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f5fe.png" height="20" width="20"> I am starting to learn japanese. Hope to progress steadily and quickly...',description:"",section:"News"},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:[%66%69%72%73%74_%6E%61%6D%65.%6C%61%73%74_%6E%61%6D%65][%61%74][%69%6E%73%74%69%74%75%74%69%6F%6E][%64%6F%74][%66%72]","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=dlu8QksAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/fabienpesquerel","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/fabien-pesquerel-73515a124","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>